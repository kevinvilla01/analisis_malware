from hashlib import md5
from virus_total_apis import PublicApi
import os

#variable q contenga mi api key
api_key = 'tu Api Key aqui'
api = PublicApi(api_key= api_key)

archivos = os.listdir()

#bucle para recorrer y enviar analisis en formato hash
for archivo in archivos:
    with open(archivo, "rb") as f:
        file_content = f.read()
        file_hash = md5(file_content).hexdigest()
        response = api.get_file_report(file_hash)

        if response["response_code"] == 200:
            if "positives" in response["results"]:
                print(f"El archivo {archivo} es malicioso.")
            else:
                print(f"El archivo {archivo} es seguro.")
        
        elif response["response_code"] == 0:
            print(f"El archivo {archivo} no se encuentra en la base de datos.")
        else:
            print(f"No se pudo obtener el analisis del archivo {archivo}.")